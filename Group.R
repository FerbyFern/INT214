#install.packages("MASS")
library(MASS)
data()
View(cats)
View(survey)

summary(cats)
summary(survey)

sample1 <- c(29,49,42,43,32,38,37,41,27,27,30)

# function ???????????????????????? mode
getmode <- function(v) {
  uniqv <- unique(v)
  uniqv[which.max(tabulate(match(v, uniqv)))]
}

#????????? function getmode
result <- getmode(x)
result

findingmode <- function(mode_number)
{
    names(which.max(table(mode_number)))
}
mode_number <- c(2,2,3,3,3,4,5,6,7)
(mode <- findingmode(mode_number))

-----------------
  Mode <- function(v) {
    # checking unique numbers in the input
    uniqv <- unique(v)
    # frquency of most occured value in the input data
    m1 <- max(tabulate(match(v, uniqv)))
    n <- length(tabulate(match(v, uniqv)))
    # if all elements are same
    same_val_check <- all(diff(v) == 0)
    if(same_val_check == F){
      # frquency of second most occured value in the input data
      m2 <- sort(tabulate(match(v, uniqv)),partial=n-1)[n-1]
      if (m1 != m2) {
        # Returning the most repeated value
        mode <- uniqv[which.max(tabulate(match(v, uniqv)))]
      } else{
        mode <- "Two or more values have same frequency. So mode can't be calculated."
      }
    } else {
      # if all elements are same
      mode <- unique(v)
    }
    return(mode)
  }

----------
x1 <- c(1,2,3,3,3,4,5)
Mode(x1)
# [1] 3

x2 <- c(1,2,3,4,5)
Mode(x2)
# [1] "Two or more varibles have same frequency. So mode can't be calculated."

x3 <- c(1,1,2,3,3,4,5)
Mode(x3)
# [1] "Two or more values have same frequency. So mode can't be calculated."




-------------------
 # ??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????? 
  #????????????????????? survey ???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????? 
  
#From Survey,There were ... non-smokers.
  count(subset(survey,Smoke == 'Heavy'))
 
#From Survey, Of the 237 people surveyed, there were 189 people who had never smoked, one of whom did not provide information. 
Smoker <- factor(survey$Smoke)

Mode(survey$Smoke, na.rm = TRUE)
summary(factor(survey$Smoke)) 

table(survey$Smoke == "Never")

#???????????????????????????????????????????????? ??????????????????????????????????????????????????????????????? ????????? 11 ??????????????????????????????????????????????????? 189 ?????????????????????????????????????????? ???????????????????????????????????? 19 ?????? ???????????????????????????????????? 17 ??????  
#In survey data. Show results of people who smoke. Of the 11 people who heavy smokers, 189 people who never smoked. Occasionally 19 people and Regularly 17 people
factor(survey$Smoke)
Smoker <- factor(survey$Smoke)
summary(Smoker)  

x <- range(survey$Age)
x


survey$Smoke[is.na(survey$Smoke)] <- "Never"
summary(survey$Smoke)


#if"Categorical" -> Replace NA with "Mode"


#install.packages("dplyr")
library(dplyr)
# Using dplyr
cats %>% dplyr::select(Hwt) %>% min()

table(survey$Smoke == "Never")

